import{_ as B,u as M,a as R,s as A,r as i,o as H,G as N,b as t,c as n,e as m,l as h,g as u,F as E,f as U,k as V,x as C}from"./index.d5019723.js";import{u as D,a as w}from"./userStore.d171f388.js";import{u as F,L as P,_ as b}from"./Posts.d3fb93bc.js";const G={class:"post-content"},I={key:0,class:"is-loading"},T={key:2,class:"no-post"},W={key:0,class:"is-loading"},$={setup(j){const d=M();D();const y=R(),_=F(),{posts:v,currentPage:l,hasNext:a}=A(_),{patchPosts:k,pushPosts:x}=_,{openModalAlert:p,openModalPaid:L}=y,r=i(!0);(async()=>{r.value=!0;const{data:e}=await w(d,l.value);e.status==="success"?(k(e.data.list),a.value=e.data.page.has_next):p(e.message),r.value=!1})();const g=i(null),c=i(!0),f=async()=>{const{top:e}=g.value.getBoundingClientRect(),o=window.innerHeight;if(c.value&&e<o&&a.value){c.value=!1,l.value+=1;const{data:s}=await w(d,l.value);s.status==="success"?(x(s.data.list),a.value=s.data.page.has_next,c.value=!0):p(s.message)}},S=()=>{var o;(o=new URLSearchParams(window.location.search).get("isPaid"))!=null&&o.startsWith("true")&&L()};return H(()=>{window.addEventListener("scroll",f),S()}),N(()=>{window.removeEventListener("scroll",f),l.value=1,a.value=!1}),(e,o)=>(t(),n("section",null,[m("div",G,[r.value?(t(),n("div",I,[h(P)])):u(v).length?(t(!0),n(E,{key:1},U(u(v),s=>(t(),C(b,{key:s._id,post:s,"data-aos":"clip-left"},null,8,["post"]))),128)):(t(),n("div",T," \u76EE\u524D\u5C1A\u7121\u52D5\u614B\uFF0C\u8A66\u8457\u65B0\u589E\u4E00\u5247\u52D5\u614B\u5427\uFF01 ")),m("div",{class:"loading-detector",ref_key:"loadingDetector",ref:g},[u(a)?(t(),n("div",W,[h(P)])):V("",!0)],512)])]))}};var O=B($,[["__scopeId","data-v-6808185e"]]);export{O as default};
